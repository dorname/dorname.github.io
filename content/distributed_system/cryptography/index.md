---
title: 加密算法
date: 2024-01-25
extra:
    image: ../logo.png
taxonomies:
  tags:
    - blockchain
  authors:
    - liguangqiao
---

# 密码学技术

## 摘要算法

- 摘要算法是指把任意长度的输入消息数据转化为固定长度的输出数据的一种密码算法，又称为散列函数 、 哈希函数 、 杂凑函数 、单向函数等。
- 摘要算法所产生的固定长度的输出数据称为 **摘要值**、**散列值**和**哈希值**。
- 摘要算法通常用来做数据完整性的判定，即对数据进行哈希计算然后比较摘要值是否一致。

### MD5算法

#### 目标

通过MD5为数据建立一个唯一数字标识

#### 特点

1. 压缩性：输出长度固定
2. 抗修改：对原数据进行任何改动，都会影响输出结果
3. 强抗碰撞：已知原数据和其MD5值，想找到MD5值相同的另一个数据极其困难

#### 作用

让大容量信息在用数字签名软件签署私人密钥前被压缩成一种保密的格式（就是把一个任意长度的字节串变换成一定长的16进制数字串）

#### 过程

MD5算法的基本过程为：填充、分块、缓冲区初始化、循环压缩、计算结果。

1. 填充

   MD5算法对于待处理信息的位长有以下要求：假设信息长度为`K`bit，填充位长为`P`bit，且`1<P<512`，要求 
   $$
   K+P = (448)mod(512)
   $$
   当`K=448(mod)512`时，`P = 512`。

   再向上述填充好的消息尾部附加`K`值得低64位，最后得到一个长度位数为`K+P+64 = 0(mod)512`的消息

2. 分块

   - 把填充后的消息分割成L个位长位512bit的分组：Y0,Y1,...,YL-1。
   - 分组结果也可表示成N个位长位32bit字M0，M1,...,MN-1,N=Lx16。

3. 缓冲区初始化

   初始化一个128位的MD缓冲区，记为CVq，表示成4个32位寄存器（A,B,C,D）;CV0 = IV。迭代在MD缓冲区进行，最后异步的128位输出即位算法结果。

4. 循环压缩，每轮循环中一次迭代运算逻辑

   对A迭代：a = b + ()

### Sha256算法

### HMacMD5和HMacSha256算法

## 对称算法

## 非对称算法

## 数字签名

## 数字证书

## PKI体系

## 国密与国际算法

### SM1 

算法类型：分组加密算法

对称加密算法中的分组加密算法，其分组长度、秘钥长度都是128bit，算法安全保密强度跟 AES 相当，但是算法不公开，仅以IP核的形式存在于芯片中，需要通过加密芯片的接口进行调用。

### SM2

算法类型：非对称加密算法

它是基于椭圆曲线密码的公钥密码算法标准，其秘钥长度256bit，包含数字签名、密钥交换和公钥加密，用于替换RSA/DH/ECDSA/ECDH等国际算法。可以满足电子认证服务系统等应用需求，由国家密码管理局于2010年12月17号发布。

SM2采用的是ECC 256位的一种，其安全强度比RSA 2048位高，且运算速度快于RSA。

### SM3

算法类型：密码杂凑算法

用于替代MD5/SHA-1/SHA-2等国际算法，适用于数字签名和验证、消息认证码的生成与验证以及随机数的生成，可以满足电子认证服务系统等应用需求，于2010年12月17日发布。

它是在SHA-256基础上改进实现的一种算法，采用Merkle-Damgard结构，消息分组长度为512bit，输出的摘要值长度为256bit。

### SM4

算法类型：分组加密算法

跟SM1类似，是我国自主设计的分组对称密码算法，用于替代DES/AES等国际算法。SM4算法与AES算法具有相同的密钥长度、分组长度，都是128bit。于2012年3月21日发布，适用于密码应用中使用分组密码的需求。

### SM9

算法类型：基于标识的非对称密码

用椭圆曲线对实现的基于标识的数字签名算法、密钥交换协议、密钥封装机制和公钥加密与解密算法，包括数字签名生成算法和验证算法，并给出了数字签名与验证算法及其相应的流程。并提供了相应的流程。可以替代基于数字证书的PKI/CA体系。

SM9主要用于用户的身份认证。据新华网公开报道，SM9的加密强度等同于3072位密钥的RSA加密算法，于2016年3月28日发布。

国密即国家密码局认定的国产密码算法。主要有SM1，SM2，SM3，SM4。密钥长度和分组长度均为128位。

由于SM1、SM4加解密的分组大小为128bit，故对消息进行加解密时，若消息长度过长，需要进行分组，要消息长度不足，则要进行填充。

### 国密算法的安全性

SM2算法：SM2椭圆曲线公钥密码算法是我国自主设计的公钥密码算法，包括SM2-1椭圆曲线数字签名算法，SM2-2椭圆曲线密钥交换协议，SM2-3椭圆曲线公钥加密算法，分别用于实现数字签名密钥协商和数据加密等功能。SM2算法与RSA算法不同的是，SM2算法是基于椭圆曲线上点群离散对数难题，相对于RSA算法，256位的SM2密码强度已经比2048位的RSA密码强度要高。

SM3算法：SM3杂凑算法是我国自主设计的密码杂凑算法，适用于商用密码应用中的数字签名和验证消息认证码的生成与验证以及随机数的生成，可满足多种密码应用的安全需求。为了保证杂凑算法的安全性，其产生的杂凑值的长度不应太短，例如MD5输出128比特杂凑值，输出长度太短，影响其安全性。SHA-1算法的输出长度为160比特，SM3算法的输出长度为256比特，因此SM3算法的安全性要高于MD5算法和SHA-1算法。

SM4算法：SM4分组密码算法是我国自主设计的分组对称密码算法，用于实现数据的加密/解密运算，以保证数据和信息的机密性。要保证一个对称密码算法的安全性的基本条件是其具备足够的密钥长度，SM4算法与AES算法具有相同的密钥长度分组长度128比特，因此在安全性上高于3DES算法。

随着国密算法推广的延伸，金融领域引入SM2、SM3、SM4等算法逐步替换原有的RSA、ECC等国外算法。现有银联银行卡联网、银联IC两项规范都引入了国密算法相关要求。如下图所示为金融活动中会应用到国密算法的业务。

## 参考文献

1. [MD5算法 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/37257569)
2. [MD5算法的Java实现-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/2099547)
